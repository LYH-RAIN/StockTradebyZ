<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é‡åŒ–é€‰è‚¡ç³»ç»Ÿ</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <!-- ä½¿ç”¨å›½å†…CDNåŠ è½½Plotly -->
    <script src="https://cdn.jsdelivr.net/npm/plotly.js@2.26.0/dist/plotly.min.js"></script>
    <script>
        // æ£€æŸ¥Plotlyæ˜¯å¦åŠ è½½æˆåŠŸ
        window.addEventListener('load', function() {
            if (typeof Plotly === 'undefined') {
                console.error('PlotlyåŠ è½½å¤±è´¥ï¼Œå°è¯•å¤‡ç”¨CDN');
                const script = document.createElement('script');
                script.src = 'https://unpkg.com/plotly.js@2.26.0/dist/plotly.min.js';
                script.onerror = function() {
                    alert('å›¾è¡¨åº“åŠ è½½å¤±è´¥ï¼ŒKçº¿å›¾åŠŸèƒ½å°†æ— æ³•ä½¿ç”¨ã€‚è¯·æ£€æŸ¥ç½‘ç»œè¿æ¥ã€‚');
                };
                document.head.appendChild(script);
            }
        });
    </script>
</head>
<body>
    <div class="container">
        <!-- å¤´éƒ¨ -->
        <header class="header">
            <h1>ğŸ“ˆ é‡åŒ–é€‰è‚¡ç³»ç»Ÿ</h1>
            <div class="date-info">
                <span id="latest-date">åŠ è½½ä¸­...</span>
            </div>
            <div style="margin-top: 15px;">
                <a href="/backtest" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 10px 20px; border-radius: 6px; text-decoration: none; display: inline-block; box-shadow: 0 2px 4px rgba(0,0,0,0.2);">
                    ğŸ“Š æˆ˜æ³•å›æµ‹
                </a>
            </div>
        </header>

        <!-- é€‰æ‹©å™¨é€‰æ‹© -->
        <div class="selector-panel">
            <h2>é€‰æ‹©æˆ˜æ³•</h2>
            <div class="selector-buttons" id="selector-buttons">
                <!-- åŠ¨æ€ç”Ÿæˆ -->
            </div>
            <button class="btn btn-secondary" onclick="compareAll()">å¯¹æ¯”æ‰€æœ‰æˆ˜æ³•</button>
        </div>

        <!-- é€‰è‚¡ç»“æœ -->
        <div class="results-panel">
            <div class="panel-header">
                <h2 id="results-title">é€‰è‚¡ç»“æœ</h2>
                <div class="filter-controls">
                    <label>
                        æ’åºï¼š
                        <select id="sort-by" onchange="sortStocks()">
                            <option value="code">è‚¡ç¥¨ä»£ç </option>
                            <option value="change">æ¶¨è·Œå¹…</option>
                            <option value="volume">æˆäº¤é‡</option>
                        </select>
                    </label>
                    <label>
                        <input type="checkbox" id="show-details" onchange="toggleDetails()">
                        æ˜¾ç¤ºè¯¦æƒ…
                    </label>
                </div>
            </div>
            
            <div class="stats" id="stats">
                <!-- ç»Ÿè®¡ä¿¡æ¯ -->
            </div>

            <div class="stock-grid" id="stock-grid">
                <div class="empty-state">
                    <p>ğŸ‘† è¯·é€‰æ‹©ä¸€ä¸ªæˆ˜æ³•æŸ¥çœ‹é€‰è‚¡ç»“æœ</p>
                </div>
            </div>
        </div>

        <!-- Kçº¿å›¾å¼¹çª— -->
        <div class="modal" id="chart-modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="modal-title">è‚¡ç¥¨ä»£ç </h3>
                    <button class="close-btn" onclick="closeModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div id="kline-chart" style="width: 100%; height: 900px;"></div>
                    <div id="volume-chart" style="display:none;"></div>
                    <div id="macd-chart" style="display:none;"></div>
                    <div id="kdj-chart" style="display:none;"></div>
                    <div id="backtest-result" style="margin-top: 20px;"></div>
                </div>
            </div>
        </div>

        <!-- å¯¹æ¯”ç»“æœå¼¹çª— -->
        <div class="modal" id="compare-modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>æˆ˜æ³•å¯¹æ¯”ç»“æœ</h3>
                    <button class="close-btn" onclick="closeCompareModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div id="compare-results"></div>
                </div>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>

