#!/bin/bash
# 抓取超时股票数据脚本
# 使用方法：./fetch_timeout_stocks.sh

# 设置TUSHARE_TOKEN（如果还没设置）
# export TUSHARE_TOKEN="你的token"

# 检查token是否设置
if [ -z "$TUSHARE_TOKEN" ]; then
    echo "错误: 请先设置环境变量 TUSHARE_TOKEN"
    echo "使用方法: export TUSHARE_TOKEN=你的token"
    exit 1
fi

echo "=========================================="
echo "开始抓取超时股票数据"
echo "=========================================="

# 超时的股票代码列表
TIMEOUT_CODES="001367 001368 001373 001376 001378 001379 002521 002522 002523 002526 002527 002528 300029 300031 300032 300033 300034 300035 300572 300573 300575 300576 300577 300578 301107 301108 301109 301110 301111 301112 600189 600193 600195 600196 600197 600198 603206 603207 603208 603209 603210 603211 605296 605298 605299 605300 605303 605305 688598 688599 688600 688601 688602 688603"

echo "股票数量: 56只"
echo "数据目录: ./data"
echo "日期范围: 2024-01-01 至 今天"
echo "并发数: 3 (降低并发避免超时)"
echo "=========================================="

# 抓取指定股票数据
python3 fetch_kline.py \
    --start 20240101 \
    --end today \
    --codes "$TIMEOUT_CODES" \
    --out ./data \
    --workers 3

echo ""
echo "=========================================="
echo "超时股票数据抓取完成！"
echo "=========================================="
echo "已抓取: 56只股票"
echo "数据保存在: ./data/"

