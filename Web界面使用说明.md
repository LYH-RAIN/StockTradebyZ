# 量化选股Web界面使用说明

## 📋 概述

这是一个可视化的量化选股系统，提供以下功能：

- ✅ **展示不同战法的选股结果**：一键运行各种选股策略
- ✅ **绘制K线图**：查看股票的历史走势和技术指标
- ✅ **对比战法**：对比不同战法的选股结果
- ✅ **实时筛选**：按涨跌幅、成交量等维度排序
- ✅ **响应式设计**：支持PC和移动端访问

## 🚀 快速开始

### 1. 安装依赖

```bash
# 安装Flask
pip3 install flask
```

### 2. 启动服务

#### 方法1：使用脚本（推荐）

```bash
./start_web.sh
```

#### 方法2：直接运行Python

```bash
python3 web_app.py
```

#### 方法3：自定义配置

```bash
python3 web_app.py --host 0.0.0.0 --port 8080 --debug
```

### 3. 访问界面

打开浏览器访问：**http://127.0.0.1:5000**

## 📖 功能说明

### 主界面

![界面示意](示意图)

主界面包含以下部分：

1. **头部**：显示系统标题和最新交易日
2. **战法选择**：显示所有可用的选股战法
3. **选股结果**：展示选中股票的详细信息
4. **K线图**：点击股票查看K线图

### 功能详解

#### 1. 选择战法

点击任意战法按钮，系统会：
- 运行该战法的选股逻辑
- 展示符合条件的股票列表
- 显示统计信息（选中数量、平均涨跌幅等）

**可用战法**：
- 少妇战法（BBIKDJSelector）
- SuperB1战法
- 补票战法（BBIShortLongSelector）
- 填坑战法（PeakKDJSelector）
- 上穿60放量战法（MA60CrossVolumeWaveSelector）
- **出坑战法（BreakoutPreviousHighSelector）** ⭐

#### 2. 查看股票详情

每个股票卡片显示：
- **股票代码**
- **当前价格**
- **涨跌幅**（红涨绿跌）
- **成交量**
- **日期**

**点击"显示详情"**可以查看更多信息：
- 开盘价、最高价、最低价
- MA5、MA20均线值

#### 3. 查看K线图

**点击股票卡片**会弹出K线图窗口，包含：

**上方：K线图**
- 📊 蜡烛图（红涨绿跌）
- 📈 MA5、MA10、MA20、MA60均线
- 🔍 支持缩放、拖动、查看具体数值

**下方：成交量图**
- 📊 柱状图显示每日成交量
- 🎨 颜色对应涨跌（红涨绿跌）

**交互功能**：
- 鼠标悬停查看具体数值
- 拖动缩放查看不同时间段
- 点击图例隐藏/显示均线

#### 4. 排序筛选

**排序选项**：
- 按股票代码：字母顺序排列
- 按涨跌幅：从高到低排序
- 按成交量：从大到小排序

**显示详情**：
- 勾选后显示每只股票的详细技术指标

#### 5. 对比战法

点击**"对比所有战法"**按钮：
- 同时运行所有激活的战法
- 显示每个战法选中的股票数量
- 列出所有选中的股票代码
- 点击股票代码可查看K线图

## 🎨 界面元素说明

### 颜色含义

- **红色**：上涨、涨幅为正
- **绿色**：下跌、跌幅为负
- **灰色**：持平、无涨跌

### 按钮状态

- **紫色渐变**：未选中的战法
- **深紫色高亮**：当前选中的战法
- **灰色**：辅助功能按钮

### 卡片效果

- **鼠标悬停**：卡片上浮，显示阴影
- **边框变色**：提示可点击查看详情

## 💡 使用技巧

### 1. 快速判断股票质量

通过以下指标快速判断：
- ✅ **涨跌幅为正**：短期趋势向上
- ✅ **价格在MA20上方**：中期趋势向上
- ✅ **成交量放大**：资金关注度高
- ⚠️ **长上影线**：警惕回调
- ⚠️ **价格跌破MA60**：长期趋势转弱

### 2. 结合K线图分析

查看K线图时注意：
- 📈 **均线多头排列**：MA5 > MA10 > MA20 > MA60（强势）
- 📉 **均线空头排列**：相反顺序（弱势）
- 🔄 **均线粘合**：趋势即将改变
- 📊 **放量突破**：突破前高且成交量放大（买入信号）
- ⚠️ **缩量上涨**：警惕后续乏力

### 3. 多战法交叉验证

如果同一只股票被多个战法同时选中：
- ✅ 说明该股票符合多个技术条件
- ✅ 技术面较强，可重点关注
- ⚠️ 仍需结合基本面和市场环境判断

### 4. 定期查看

建议使用频率：
- **每日盘后**：运行战法，查看当日选股结果
- **周末复盘**：对比不同战法，总结规律
- **关键点位**：大盘突破或回调时重点关注

## 📊 数据说明

### 数据来源

- **数据目录**：`./data/`
- **数据格式**：CSV文件，每个文件代表一只股票
- **数据类型**：日线前复权数据
- **更新方式**：使用`fetch_kline.py`手动更新

### 数据字段

| 字段 | 说明 | 示例 |
|------|------|------|
| date | 交易日期 | 2024-11-21 |
| open | 开盘价 | 10.50 |
| close | 收盘价 | 10.80 |
| high | 最高价 | 11.00 |
| low | 最低价 | 10.40 |
| volume | 成交量 | 28867.0 |

### 技术指标计算

- **MA5**：5日均线
- **MA10**：10日均线
- **MA20**：20日均线
- **MA30**：30日均线
- **MA60**：60日均线

## ⚙️ 配置说明

### 修改配置文件

编辑`configs.json`可以：
- 激活/停用战法：修改`activate`字段
- 调整战法参数：修改`params`字段
- 修改战法别名：修改`alias`字段

**示例**：

```json
{
  "class": "BreakoutPreviousHighSelector",
  "alias": "出坑战法",
  "activate": true,
  "params": {
    "lookback_days": 60,
    "vol_ratio_threshold": 2.0
  }
}
```

### 修改监听地址

```bash
# 监听所有网卡（允许外部访问）
python3 web_app.py --host 0.0.0.0

# 修改端口
python3 web_app.py --port 8080

# 开启调试模式
python3 web_app.py --debug
```

## 🐛 常见问题

### Q1: 启动失败，提示模块不存在

**原因**：缺少Flask依赖

**解决**：
```bash
pip3 install flask
```

### Q2: 页面打不开或显示空白

**原因**：
1. 服务未启动
2. 数据目录为空
3. 浏览器缓存问题

**解决**：
1. 确认服务已启动，查看终端日志
2. 检查`./data/`目录是否有CSV文件
3. 清除浏览器缓存，刷新页面

### Q3: 选股结果为空

**原因**：
1. 当前市场条件不符合战法要求
2. 数据不完整
3. 战法参数过于严格

**解决**：
1. 正常现象，换个战法试试
2. 重新下载数据
3. 调整`configs.json`中的参数

### Q4: K线图显示不完整

**原因**：数据不足120天

**解决**：
- 下载更长时间的历史数据
- 或等待数据积累

### Q5: 服务占用端口

**错误信息**：`Address already in use`

**解决**：
```bash
# 查找占用端口的进程
lsof -i:5000

# 杀死进程
kill -9 <PID>

# 或使用其他端口
python3 web_app.py --port 5001
```

## 🔒 安全建议

1. **不要暴露到公网**：默认只监听127.0.0.1
2. **添加认证**：如需远程访问，建议添加登录功能
3. **HTTPS**：生产环境使用HTTPS加密
4. **防火墙**：配置防火墙规则

## 📈 性能优化

### 数据加载

- 启动时会加载所有股票数据到内存
- 数据量大时启动较慢（正常现象）
- 建议只保留需要的股票数据

### 响应速度

- 首次运行战法较慢（数据计算）
- 后续运行会更快（内存缓存）
- K线图加载快速（120天数据）

## 🎯 下一步

体验Web界面后，你可以：

1. **实盘验证**：
   - 每日盘后运行战法
   - 记录选股结果
   - 跟踪后续表现

2. **优化战法**：
   - 调整参数配置
   - 对比不同参数效果
   - 开发新战法

3. **回测验证**：
   ```bash
   python3 backtest.py
   ```

4. **导出数据**：
   - 可通过API导出选股结果
   - 进行进一步分析

---

## 📞 技术支持

遇到问题？

1. 查看控制台日志
2. 检查浏览器开发者工具
3. 查看`fetch.log`日志文件
4. 提交Issue

---

**祝你选股顺利，投资愉快！** 📊✨

